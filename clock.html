<html>
    <head>
        <title>Relax | Clock</title>
        <link href="https://fonts.googleapis.com/css?family=Jura" rel="stylesheet">
        <style>
            body {
                font-family: 'Jura', sans-serif;
                background-image: url('images/cat_in_chair.png');
                background-position: center;
                background-repeat: no-repeat;
                background-size: cover;
            }
            #day {
                font-size: 60px;
                font-weight: 900;
                color: white;
            }
            #date {
                font-size: 40px;
                font-weight: 900;
                color: white;
            }
            #time {
                font-size: 112px;
                font-weight: 900;
                color: white;
            }
            #imgtitle {
                font-size: 16px;
                color: white;
            }
        </style>
    </head>
    <body>
        
        <div id='day'>Loading...</div><br>
        <div id='date'></div><br>
        <div id='time'></div><br>
        <div id='imgtitle'></div>
        <script>
            const GET = 'GET';
            const NASAurl = 'https://api.nasa.gov/planetary/apod';
            const NASAquery = '?api_key=';
            const NASAapikey = 'K3bhj7MJUTlPBfkKIbhTcOG5gCLXk94B1eswlTu7';
            // Create a request variable and assign a new XMLHttpRequest object to it.
            let request = new XMLHttpRequest();
            // Open a new connection, using the GET request on the URL endpoint
            request.open(GET, NASAurl + NASAquery + NASAapikey, true);
            request.onload = function () {
            // Begin accessing JSON data here
                if (request.status >= 200 && request.status < 400) {
                    let data = JSON.parse(this.responseText);
                    document.body.style.backgroundImage = "url('" + data.url + "')";
                    imgtitle.textContent = data.title;
                } else {
                    imgtitle.textContent = request.status;
                }
            };
            // Send request
            request.send();
            // Get URL parameters
            let urlParams = new URLSearchParams(window.location.search);
            let locale = urlParams.get('locale');
            const defaultLocale = 'en-GB';
            const hour12Param12 = '12';
            const on = 'on';
            if (locale === null) {
                locale = defaultLocale;
            };
            const dayOptions = { 
                weekday: 'long',
            };
            const dateOptions = {  
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
            };
            const timeOptions = {  
                hour: 'numeric', 
                minute: 'numeric',
                hour12: false
            };
            let hour12Param = urlParams.get('hour12');
            if (hour12Param === hour12Param12) {
                timeOptions.hour12 = true;
            };
            let secondsParam = urlParams.get('seconds');
            if (secondsParam === on) {
                timeOptions.second = 'numeric';
            };
            const refreshRate=1000; // Refresh rate in milliseconds
            let t = setInterval(displayClock, refreshRate);
            function displayClock() {
                let dateObj = new Date();
                day.textContent = dateObj.toLocaleDateString(locale, dayOptions);
                date.textContent = dateObj.toLocaleDateString(locale, dateOptions);
                time.textContent = dateObj.toLocaleTimeString(locale, timeOptions);
            };
        </script>
    </body>
</html>